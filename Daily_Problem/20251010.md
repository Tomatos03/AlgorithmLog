# [3147. 从魔法师身上吸取的最大能量](https://leetcode.cn/problems/taking-maximum-energy-from-the-mystic-dungeon/)

## 解题思路

1. 当确定了一个起点$i$之后, 后续所有需要经过的点都是确定的
1. 多个起点可能存在一些公共点, 为了减少重复计算, 需要将结果记忆化


## 参考代码

+ 时间复杂度$O(n)$

### 递归


```cpp
using i64 = long long;
class Solution {
    vector<int> e;
    vector<int> memo;
    int n, k;
    int dfs(int x) {
        if (x >= n) {
            return 0;
        }

        if (memo[x] != INT_MIN) {
            return memo[x];
        }

        memo[x] = max(memo[x], dfs(x + k) + e[x]);
        return memo[x];
    }

public:
    int maximumEnergy(vector<int>& energy, int k) {
        this->n = energy.size();
        this->k = k;
        this->e = energy;
        memo = vector<int>(n, INT_MIN);
        int ans = INT_MIN;
        for (int i = 0; i < n; ++i) {
            ans = max(ans, dfs(i));
        }
        return ans;
    }
};

```

### 递推

1. 预处理每一个跳跃点能够得到的能量

```cpp
using i64 = long long;
class Solution {
public:
    int maximumEnergy(vector<int>& energy, int k) {
        int n = energy.size(), ans = INT_MIN;
        vector<int> suf(n + k);
        for (int i = n - 1; i >= 0; --i) {
            suf[i] = suf[i + k] + energy[i];
            ans = max(ans, suf[i]);
        }
        return ans;
    }
};

```

