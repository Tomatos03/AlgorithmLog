# [3484. 设计电子表格](https://leetcode.cn/problems/design-spreadsheet/)

## 解题思路

1. 本题难点在于getValue(string)函数, 对于这个函数输入的字符串$=A+B$, 可以先查找加号的位置, 再根据加号的位置划分出两部分字符串(加号左边和右边的字符串), 第一部分去掉第一个字符等号, 然后两部分字符串分别在判断第一个字符是否包含大写字母


##  参考代码


```cpp
class Spreadsheet {
    vector<vector<int>> vec;
public:
    Spreadsheet(int rows) {
        vec = vector<vector<int>>(rows + 1, vector<int>(26));
    }

    void setCell(string cell, int value) {
        int row = stoi(cell.substr(1)), col = cell[0] - 'A';
        vec[row][col] = value;
    }

    void resetCell(string cell) {
        setCell(cell, 0);
    }

    int getValue(string formula) {
        int mid = formula.find('+');
        string str_a = formula.substr(1, mid - 1), str_b = formula.substr(mid + 1);
        int a = 'A' <= str_a[0] && str_a[0] <= 'Z' ? vec[stoi(str_a.substr(1))][str_a[0] - 'A'] : stoi(str_a);
        int b = 'A' <= str_b[0] && str_b[0] <= 'Z' ? vec[stoi(str_b.substr(1))][str_b[0] - 'A'] : stoi(str_b);
        return a + b;
    }
};

```
