# [837. 新 21 点](https://leetcode.cn/problems/new-21-game/)

## 解题思路

1. 原问题等价于: 在当前得分为$0$的情况下按照游戏规则继续进行游戏得分不超过$n$的概率

2. 在选定了一个数之后, 可以得到和原问题相似的一个子问题, 因此可以使用递归或者递推解决这个问题

3. 让$f[i]$表示在满足游戏规则的前提下, 得$i$分的概率

$$
\begin{aligned}
f[i] &= p \times \big(f[i-1] + f[i-2] + \dots + f[i-\text{maxPts}-1]\big) \\
     &= p \times \big(pre[i-1] - pre[i-1-\text{maxPts}]\big)
\end{aligned}
$$



```cpp
using i32 = int;
using i64 = long long;
using pii = pair<int, int>;
using pll = pair<i64, i64>;
const int mod = 1000000007, mod0 = 998244353;
class Solution {
public:
    double new21Game(int n, int k, int maxPts) {
        if (k == 0)
            return 1;
        
        double p = 1.0 / maxPts;

        vector<double> f(n + 1), pre(n + 1);
        f[0] = pre[0] = 1;

        double ans = 0.0;
        for (int i = 1; i <= min(k + maxPts - 1, n); ++i) {
            f[i] = p * (pre[min(i - 1, k - 1)] - (i - maxPts - 1 < 0 ? 0 : pre[i - maxPts - 1]));
            pre[i] = pre[i - 1] + f[i];

            if (i >= k)
                ans += f[i];
        }
        return ans;
    }
};

```

