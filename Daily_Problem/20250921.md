# [1912. 设计电影租借系统](https://leetcode.cn/problems/design-movie-rental-system/)

## 解题思路

1. 利用一个$map<pii, int>$存储$(movie, shop)$与价格的映射
1. 利用一个$map<int, set<pii>>$存储$movie$与$(price, shop)$的映射
1. 利用一个$set<vector<int>>$存储借出的电影的信息$(price, shop, movie)$
1. 借出时$set<vector<int>>$添加一个新的信息, $map<int, st<pii>>$删除对应的信息, 还书时这个guo cheng


```cpp
using pii = pair<int, int>;
class MovieRentingSystem {
    map<int, set<pii>> movie_mp;
    map<pii, int> movie_shop_mp;
    set<vector<int>> st;
public:
    MovieRentingSystem(int n, vector<vector<int>>& entries) {
        int size = entries.size();
        for (const auto& entry : entries) {
            int shop = entry[0];
            int movie = entry[1];
            int price = entry[2];

            movie_mp[movie].insert({price, shop});
            movie_shop_mp[{movie, shop}] = price;
        }
    }

    vector<int> search(int movie) {
        auto it = movie_mp[movie].begin();
        int size = movie_mp[movie].size();

        vector<int> ans;
        for (int i = 0; i < min(5, size); ++i, it = next(it)) {
            ans.push_back(it->second);
        }
        return ans;
    }

    void rent(int shop, int movie) {
        int price = movie_shop_mp[{movie, shop}];
        movie_mp[movie].erase({price, shop});
        st.insert({price, shop, movie});
    }

    void drop(int shop, int movie) {
        int price = movie_shop_mp[{movie, shop}];
        movie_mp[movie].insert({price, shop});
        st.erase({price, shop, movie});
    }

    vector<vector<int>> report() {
        auto it = st.begin();
        int size = st.size();
        vector<vector<int>> ans;
        for (int i = 0; i < min(size, 5); ++i, it = next(it)) {
            vector<int> tmp = *it;
            ans.push_back({tmp[1], tmp[2]});
        }
        return ans;
    }
};

```
